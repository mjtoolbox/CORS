<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
    <title>BC Hydro - eMetering</title>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="Content-Language" content="en-us" />
    <meta http-equiv="imagetoolbar" content="false" />
    <meta name="MSSmartTagsPreventParsing" content="true" />
    <meta name="robots" content="all" />
    <meta name="copyright" content="Copyright (c) 2008 BC Hydro" />

    <link rel="stylesheet" type="text/css" media="all" href="includes/css/interim_extranet_apps.css" />

    <script src="scripts/jquery-1.12.3.min.js" type="text/javascript">
    </script>
    <style>
        /* The Modal (background) */
        
        .modal {
            display: none;
            /* Hidden by default */
            position: fixed;
            /* Stay in place */
            z-index: 1;
            /* Sit on top */
            padding-top: 100px;
            /* Location of the box */
            left: 0;
            top: 0;
            width: 100%;
            /* Full width */
            height: 100%;
            /* Full height */
            overflow: auto;
            /* Enable scroll if needed */
            background-color: rgb(0, 0, 0);
            /* Fallback color */
            background-color: rgba(0, 0, 0, 0.4);
            /* Black w/ opacity */
        }
        /* Modal Content */
        
        .modal-content {
            position: relative;
            background-color: #fefefe;
            margin: auto;
            padding: 0;
            border: 1px solid #888;
            width: 50%;
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
            -webkit-animation-name: animatetop;
            -webkit-animation-duration: 0.4s;
            animation-name: animatetop;
            animation-duration: 0.4s
        }
        /* Add Animation */
        
        @-webkit-keyframes animatetop {
            from {
                top: -300px;
                opacity: 0
            }
            to {
                top: 0;
                opacity: 1
            }
        }
        
        @keyframes animatetop {
            from {
                top: -300px;
                opacity: 0
            }
            to {
                top: 0;
                opacity: 1
            }
        }
        /* The Close Button */
        
        .close {
            color: white;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }
        
        .close:hover,
        .close:focus {
            color: #000;
            text-decoration: none;
            cursor: pointer;
        }
        
        .modal-header {
            padding: 2px 16px;
            background-color: #5cb85c;
            color: white;
        }
        
        .modal-body {
            padding: 2px 16px;
        }
        
        .modal-footer {
            padding: 2px 16px;
            background-color: #5cb85c;
            color: white;
        }
        
        a.modalbtn {
            -webkit-appearance: button;
            -moz-appearance: button;
            appearance: button;
            text-decoration: none;
            color: initial;
        }
    </style>

</head>

<body>
    <div id="container">
        <div id="header">
            <IMG alt=BChydro src="includes/img/BC_Hydro_logo.png">
        </div>
        <!-- /end #header -->

        <div id="bodyWrapper">
            <div id="sideBar">
                <div id="sideNav">
                    <h4>Registered User</h4>
                    <div class="sidebarstd">
                        Already an eMetering user?
                        <br /> Log in below.
                    </div>
                    <form method="POST" name="emeterLoginForm" id="emeterLoginForm" action="index.html">
                        <div class="sidebarstd">
                            <b>User ID</b>
                            <input type="text" name="UserID" id="UserID" />
                        </div>
                        <div class="sidebarstd">
                            <b>Password</b>
                            <input type="password" name="password" id="password" />
                        </div>
                        <div class="sidebarstd" align="right">
                            <!-- 		<input name="request" type="submit" class="submitCancel"
								id="ajax" value="Login" /><br />  -->
                            <input type="button" id="loginButton" value="Login" />
                            <br>
                        </div>
                        <input type="hidden" name="width" />
                        <input type="hidden" name="height" />
                        <input type="hidden" name="browser" />

                        <!-- The Modal -->
                        <div id="myModal" class="modal">

                            <!-- Modal content -->
                            <div class="modal-content">
                                <div class="modal-header">
                                    <span class="close">Ã—</span>
                                    <h2>Select Destination</h2>
                                </div>
                                <div class="modal-body">
                                    <table>
                                        <tr>
                                            <th><a href="http://w3t3:7002/emeter/adminLogin.html" class="modalbtn">eMeter</a></th>
                                            <th><a href="http://google.com" class="modalbtn">Demand Response</a></th>
                                        </tr>
                                    </table>
                                </div>
                                <div class="modal-footer">
                                    <h3>Modal Footer</h3>
                                </div>
                            </div>
                        </div>

                    </form>
                </div>
            </div>
            <!-- /end #sideNav -->
        </div>
        <!-- /end #sideBar -->

        <div id="bcMain">
            <div id="bodyContent">
                <h1 style="text-transform: none;">Power Smart eMetering</h1>
                <div id="bcLeftCol">
                    <div id="Application">
                        <p>BC Hydro's Power Smart e.Metering allows you to read the interval data from your BC Hydro revenue meter.</p>
                        <p>
                            <a href="http://www.bchydro.com/powersmart/business.html">More
								about Energy Savings Programs</a>
                        </p>
                        <p>
                            <b>Forgot your User ID / Password?</b>
                            <br /> eMail: transmission.billing@bchydro.com
                            <br />
                    </div>
                    <!-- /end #Application -->
                </div>
                <div id="rightBar">
                    <div class="dialog">
                        <div class="hd">
                            <div class="c"></div>
                        </div>
                        <div class="bd">
                            <div class="c">
                                <div class="s">
                                    <h2>Quick Tip</h2>
                                    <p>In eMetering all metering times go to 12:00 a.m. Pacific Standard Time.</p>
                                </div>
                            </div>
                        </div>
                        <div class="ft">
                            <div class="c"></div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- /end #bodyContent -->
        </div>
        <!-- /end #bcMain -->
    </div>
    <!-- /end #bodyWrapper -->
    </div>
</body>
<script>
    // Get the modal
    var modal = document.getElementById('myModal');

    // Get the <span> element that closes the modal
    var span = document.getElementsByClassName("close")[0];

    $(document).ready(function () {

        modal.style.display = "none";

        $("#loginButton").click(function () {

            var username = $("#UserID").val();
            var passwd = $("#password").val();


            $.ajax({
                    type: "GET",
                    url: 'http://localhost:9988/success',
                    dataType: 'json',
                })
                .done(function (data) {
                    var parsed = data;
                    console.log(username + " " + passwd + " " + parsed[0].Status);
                    var status = parsed[0].Status;
                    var dr = parsed[0].DR;
                    if (status == 'OK' && dr == 'No') {
                        //Check DR No w/o token. Direct to old eMeter ap.
                        location.href = "http://w3t3:7002/emeter/adminLogin.html";
                    }
                    if (status == 'OK' && dr == 'Yes') {
                        //Check DR yes w token. Show popup to give them option.


                    } else if (status == 'Bad password') {
                        // DR no w/o token


                    } else if (status == 'Error') {
                        // DR no w/o token

                    } else {
                        //
                    };
                    modal.style.display = "block";
                });
            //                .success(function (data) {
            //                    var parsed = data;
            //                    console.log(username + " " + passwd + " " + parsed[0].Status);
            //                    modal.style.display = "block";
            //                })
            //                .error(function (data, errorThrown) {
            //                    alert('error');
            //                    console.log(data);
            //                }); // end ajax

            return false; // keeps the page from not refreshing 
        });


    });

    // When the user clicks on <span> (x), close the modal
    span.onclick = function () {
            modal.style.display = "none";
        }
        // When the user clicks anywhere outside of the modal, close it
    window.onclick = function (event) {
        if (event.target == modal) {
            modal.style.display = "none";
        }
    }
</script>

</html>